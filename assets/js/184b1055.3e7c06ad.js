"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[3162],{5802:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>c,metadata:()=>o,toc:()=>i});var a=t(5893),s=t(1151);const c={},r="canvas \u5706\u73af\u5012\u8ba1\u65f6",o={id:"js/modules/canvas-countdown",title:"canvas \u5706\u73af\u5012\u8ba1\u65f6",description:"\u9884\u89c8",source:"@site/docs/js/modules/canvas-countdown.md",sourceDirName:"js/modules",slug:"/js/modules/canvas-countdown",permalink:"/docs/js/modules/canvas-countdown",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/js/modules/canvas-countdown.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u6309\u94ae\u7cfb\u7edf\u5207\u6362\u903b\u8f91",permalink:"/docs/js/modules/button"},next:{title:"\u81ea\u5b9a\u4e49\u5bfc\u822a",permalink:"/docs/js/modules/custom-nav"}},d={},i=[{value:"\u9884\u89c8",id:"\u9884\u89c8",level:2},{value:"js",id:"js",level:2},{value:"scss",id:"scss",level:2},{value:"html",id:"html",level:2}];function l(n){const e={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",img:"img",p:"p",pre:"pre",...(0,s.a)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.h1,{id:"canvas-\u5706\u73af\u5012\u8ba1\u65f6",children:"canvas \u5706\u73af\u5012\u8ba1\u65f6"}),"\n",(0,a.jsx)(e.h2,{id:"\u9884\u89c8",children:"\u9884\u89c8"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.a,{href:"https://audfree.dev.joyonet.biz/promotion/black-friday/",children:"\u7ec4\u4ef6\u5730\u5740"}),(0,a.jsx)(e.br,{}),"\n",(0,a.jsx)(e.img,{src:t(7482).Z+"",width:"792",height:"217"})]}),"\n",(0,a.jsx)(e.h2,{id:"js",children:"js"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-js",children:'// canvas\u5706\u73af\u5012\u8ba1\u65f6 BEGIN\n(function () {\n  // \u5230\u671f\u65f6\u95f4\n  // \u8bbe\u7f6e\u5012\u8ba1\u65f6\u65f6\u95f4\uff1a\u5e74 \u6708 \u65e5 \u5c0f\u65f6 \u5206\u949f \u79d2 \u6beb\u79d2\n  endTime = setEndTime(2023, 11, 30, 8, 0, 0);\n\n  // \u8bbe\u7f6e\u5230\u671f\u65f6\u95f4\n  function setEndTime(year, month, day, hour, minute, millisecond) {\n    return new Date(year, month - 1, day, hour, minute, millisecond);\n  }\n\n  // \u83b7\u53d64\u4e2a canvas \u5143\u7d20\n  var days_canvas = document.getElementById("days");\n  var hours_canvas = document.getElementById("hours");\n  var minutes_canvas = document.getElementById("minutes");\n  var seconds_canvas = document.getElementById("seconds");\n\n  // \u8ba1\u7b97\u8ddd\u79bb\u5230\u671f\u65f6\u95f4\u8fd8\u5269\u4e0b\u591a\u5c11 days, hours, minutes\n  function getLeftTimeObj() {\n    var date = new Date();\n    var millisecond = date.getTime();\n    var end_millisecond = endTime.getTime();\n\n    if (end_millisecond < millisecond) {\n      return {\n        days: 0,\n        hours: 0,\n        minutes: 0,\n        seconds: 0,\n      };\n    }\n\n    // \u8ddd\u79bb\u7ed3\u675f\u65f6\u95f4\u7684\u79d2\u6570\n    var left_seconds = (end_millisecond - millisecond) / 1000;\n\n    var seconds = left_seconds % 60;\n    var left_minutes = (left_seconds - seconds) / 60;\n    var minutes = left_minutes % 60;\n    var left_hours = (left_minutes - minutes) / 60;\n    var hours = left_hours % 24;\n    var left_days = (left_hours - hours) / 24;\n\n    return {\n      days: left_days,\n      hours: hours,\n      minutes: minutes,\n      seconds: seconds,\n    };\n  }\n\n  var dateObj = getLeftTimeObj();\n\n  // \u753b\u6574\u4e2a\u5706\n  function drawCricle(canvas) {\n    var context = canvas.getContext("2d");\n    var centerX = canvas.width / 2;\n    var centerY = canvas.height / 2;\n\n    context.save();\n    context.beginPath();\n    context.lineWidth = 6;\n    context.strokeStyle = "#414141";\n    context.fillStyle = "#000";\n    context.arc(centerX, centerY, canvas.width / 2 - 3, 0, Math.PI * 2, true);\n    context.fill();\n    context.stroke();\n    context.closePath();\n    context.restore();\n  }\n\n  // \u753b\u6570\u5b57\u4e0b\u7684\u5b57\u7b26\n  function drawStr(canvas, str) {\n    var context = canvas.getContext("2d");\n    var centerX = canvas.width / 2;\n    var centerY = canvas.height / 2;\n\n    context.save();\n    context.fillStyle = "#848484";\n    context.font = "18px Arial"; //\u8bbe\u7f6e\u5b57\u4f53\u5927\u5c0f\u548c\u5b57\u4f53\n    context.textAlign = "center";\n    context.fillText(str, centerX, centerY + 40);\n    context.restore();\n  }\n\n  // \u753b\u6570\u5b57\n  function drawNumber(canvas, num) {\n    var context = canvas.getContext("2d");\n    var centerX = canvas.width / 2;\n    var centerY = canvas.height / 2;\n    num = num.toFixed();\n    num = num < 10 ? "0" + num : num;\n\n    context.save();\n    context.fillStyle = "#FFF";\n    context.font =\n      window.innerWidth >= 768 ? "bold 58px Arial" : "bold 50px Arial"; //\u8bbe\u7f6e\u5b57\u4f53\u5927\u5c0f\u548c\u5b57\u4f53\n    context.textAlign = "center";\n    context.fillText(num, centerX, centerY + 8);\n    context.restore();\n  }\n\n  // \u753b\u8fdb\u5ea6\u6761 -0.5\u4e3a\u8d77\u70b9\n  // percentage \u4e3a\u8fdb\u5ea6\u6761\u7684\u767e\u5206\u6bd4\uff080<percentage<1\uff09\uff0c 1 \u8868\u793a\u6574\u4e2a\u5706\n  function drawProgress(canvas, percentage) {\n    var context = canvas.getContext("2d");\n    var centerX = canvas.width / 2;\n    var centerY = canvas.height / 2;\n\n    var end_cricle = -percentage * 2 + 1.5;\n    // var end_cricle = 1.2;\n    end_cricle = Number(end_cricle.toFixed(4));\n\n    // \u8bbe\u7f6e\u5782\u76f4\u6e10\u53d8\n    // var linearGrad = context.createLinearGradient(canvas.width / 2, 0, canvas.width / 2, canvas.height);\n    // linearGrad.addColorStop(0, \'#ff0503\');\n    // linearGrad.addColorStop(1, \'#ff8200\');\n\n    context.save();\n    // context.strokeStyle = linearGrad; //\u8bbe\u7f6e\u63cf\u8fb9\u6837\u5f0f\n    context.strokeStyle = "#fff"; //\u8bbe\u7f6e\u63cf\u8fb9\u6837\u5f0f\n    context.lineCap = "round"; //\u5706\u89d2\n    context.lineWidth = 6; //\u8bbe\u7f6e\u7ebf\u5bbd\n    context.beginPath(); //\u8def\u5f84\u5f00\u59cb\n    context.arc(\n      centerX,\n      centerY,\n      canvas.width / 2 - 3,\n      -0.5 * Math.PI,\n      end_cricle * Math.PI,\n      true\n    ); //\u7528\u4e8e\u7ed8\u5236\u5706\u5f27context.arc(x\u5750\u6807\uff0cy\u5750\u6807\uff0c\u534a\u5f84\uff0c\u8d77\u59cb\u89d2\u5ea6\uff0c\u7ec8\u6b62\u89d2\u5ea6\uff0c\u987a\u65f6\u9488/\u9006\u65f6\u9488)\n    context.stroke(); //\u7ed8\u5236\n    context.closePath(); //\u8def\u5f84\u7ed3\u675f\n    context.restore();\n  }\n\n  // \u6e05\u9664 canvas \u5185\u5bb9\n  function clear() {\n    var days_ctx = days_canvas.getContext("2d");\n    var hours_ctx = hours_canvas.getContext("2d");\n    var minutes_ctx = minutes_canvas.getContext("2d");\n    var seconds_ctx = seconds_canvas.getContext("2d");\n\n    days_ctx.clearRect(0, 0, days_canvas.width, days_canvas.height);\n    hours_ctx.clearRect(0, 0, hours_canvas.width, hours_canvas.height);\n    minutes_ctx.clearRect(0, 0, minutes_canvas.width, minutes_canvas.height);\n    seconds_ctx.clearRect(0, 0, seconds_canvas.width, seconds_canvas.height);\n  }\n\n  // \u7ed8\u56fe\n  function draw() {\n    drawCricle(days_canvas);\n    drawCricle(hours_canvas);\n    drawCricle(minutes_canvas);\n    drawCricle(seconds_canvas);\n    drawStr(days_canvas, "DAYS");\n    drawStr(hours_canvas, "HRS");\n    drawStr(minutes_canvas, "MINS");\n    drawStr(seconds_canvas, "SECS");\n\n    drawProgress(days_canvas, dateObj.days / 30 >= 1 ? 1 : dateObj.days / 30);\n    drawNumber(days_canvas, dateObj.days);\n    drawProgress(hours_canvas, (dateObj.hours / 24).toFixed(4));\n    drawNumber(hours_canvas, dateObj.hours);\n    drawProgress(minutes_canvas, (dateObj.minutes / 60).toFixed(4));\n    drawNumber(minutes_canvas, dateObj.minutes);\n    drawProgress(seconds_canvas, (dateObj.seconds / 60).toFixed(4));\n    drawNumber(seconds_canvas, dateObj.seconds);\n  }\n\n  draw();\n\n  (function count() {\n    requestAnimationFrame(count);\n    clear();\n    dateObj = getLeftTimeObj();\n    draw();\n  })();\n})();\n// canvas\u5706\u73af\u5012\u8ba1\u65f6 END\n'})}),"\n",(0,a.jsx)(e.h2,{id:"scss",children:"scss"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-scss",metastring:'title="scss"',children:'.banner__countdown {\n  text-align: center;\n  .tips {\n    margin-bottom: 45px;\n    display: inline-block;\n    padding: 4px 18px 6px;\n\n    border-radius: 5px;\n    border: solid 1px #fffeff;\n\n    font-size: 18px;\n    line-height: 24px;\n    color: #fffeff;\n    @include respond-to(max-sm) {\n      margin-bottom: 30px;\n      font-size: 14px;\n      line-height: 20px;\n      padding: 3px 15px 5px;\n    }\n  }\n  .countdown__group {\n    display: flex;\n    justify-content: center;\n    .clock {\n      margin: 0 26px;\n      position: relative;\n      width: 140px;\n      height: 140px;\n      canvas {\n        width: 100%;\n        height: 100%;\n      }\n      @include respond-to(max-sm) {\n        margin: 0 10px;\n        width: 60px;\n        height: 60px;\n      }\n    }\n    .days,\n    .hours,\n    .minutes {\n      &:after,\n      &:before {\n        content: "";\n        display: block;\n        width: 8px;\n        height: 8px;\n        background-color: #fff;\n        position: absolute;\n        right: -30px;\n        @include respond-to(max-sm) {\n          right: -11px;\n          width: 4px;\n          height: 4px;\n        }\n      }\n      &:after {\n        bottom: calc(50% - 17px);\n        @include respond-to(max-sm) {\n          bottom: calc(50% - 8px);\n        }\n      }\n      &:before {\n        top: calc(50% - 17px);\n        @include respond-to(max-sm) {\n          top: calc(50% - 8px);\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"html",children:"html"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-html",metastring:'title="html"',children:'<div class="banner__countdown">\n  <p class="tips">This Offer Expires in</p>\n  <div class="countdown__group">\n    <div class="clock days">\n      <canvas id="days" width="140" height="140"></canvas>\n    </div>\n    <div class="clock hours">\n      <canvas id="hours" width="140" height="140"></canvas>\n    </div>\n    <div class="clock minutes">\n      <canvas id="minutes" width="140" height="140"></canvas>\n    </div>\n    <div class="clock seconds">\n      <canvas id="seconds" width="140" height="140"></canvas>\n    </div>\n  </div>\n</div>\n'})})]})}function u(n={}){const{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(l,{...n})}):l(n)}},7482:(n,e,t)=>{t.d(e,{Z:()=>a});const a=t.p+"assets/images/canvas-clock-daa9f6fab619565cae3237a7452196d4.png"},1151:(n,e,t)=>{t.d(e,{Z:()=>o,a:()=>r});var a=t(7294);const s={},c=a.createContext(s);function r(n){const e=a.useContext(c);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:r(n.components),a.createElement(c.Provider,{value:e},n.children)}}}]);